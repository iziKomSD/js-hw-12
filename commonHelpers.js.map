{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst keyApi = '26468965-37c536f46ba330a607460f03f';\n\nexport async function getImages(query, perPage = 15, pageNum) {\n  const queryParams = new URLSearchParams({\n    key: keyApi,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: perPage,\n    page: pageNum,\n  });\n\n  const response = await axios.get('', { params: queryParams });\n  return response.data;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { getImages } from './pixabay-api';\n\nconst gallery = document.querySelector('.gallery');\nconst form = document.querySelector('.search-form'); //look for form\nconst loader = document.querySelector('.loader'); // btn for loading more images\nconst loadMore = document.querySelector('.load-more');\nlet inputValue = ''; //for reusing search to get more pics rendering by btn load more\nlet pageNum;\nlet currentQuery;\n\nform.addEventListener('submit', imageFetch);\nloadMore.addEventListener('click', loadMorePics);\nloadMore.classList.add('is-hidden');\n\nfunction imageFetch(event) {\n  event.preventDefault();\n  gallery.innerHTML = '';\n  loader.classList.remove('is-hidden');\n  inputValue = event.currentTarget.elements.search.value.trim(); //current value-first render\n\n  if (inputValue === '') {\n    iziToast.error({\n      title: 'Error',\n      message: `Please enter a search query.`,\n      backgroundColor: '#EF4040',\n      messageColor: '#fff',\n      titleColor: '#fff',\n      progressBarColor: '#B51B1B',\n      position: 'topRight',\n    });\n    loader.classList.add('is-hidden');\n    return;\n  }\n  loader.classList.remove('is-hidden');\n\n  getImages(inputValue, 15, 1)\n    .then(response => {\n      if (response.hits.length === 0) {\n        throw new Error('No images found');\n      }\n      renderGalleryImages(response.hits); //call func and give response\n      currentQuery = inputValue;\n      pageNum = 1;\n      loadMore.classList.remove('is-hidden');\n      event.target.reset(); //reset input\n    })\n    .catch(error => {\n      iziToast.error({\n        title: 'Error',\n        message: `${error.message || 'Something went wrong'}`,\n        backgroundColor: '#EF4040',\n        messageColor: '#fff',\n        titleColor: '#fff',\n        progressBarColor: '#B51B1B',\n        position: 'topRight',\n      });\n      loadMore.classList.add('is-hidden');\n    })\n    .finally(() => {\n      loader.classList.add('is-hidden');\n    });\n}\n\nconst lightbox = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n});\n\nlet renderCount = 0;\n// rendering images\nfunction renderGalleryImages(images) {\n  const html = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class ='gallery-item'>\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"\n                width=\"360\"\n                height=\"152\"/>\n        </a>  \n        <div class='info-block'>\n            <div class=\"info\">\n                <h3 class = \"head-likes\">Likes</h3>\n                <p>${likes}</p>\n            </div>\n            <div class=\"info\">\n                <h3 class = \"head-views\">Views</h3>\n                <p>${views}</p>\n            </div>\n            <div class=\"info\">\n                <h3 class = \"head-comments\">Comments</h3>\n                <p>${comments}</p>\n            </div>\n            <div class=\"info\">\n                <h3 class = \"head-downloads\">Downloads</h3>\n                <p>${downloads}</p>\n            </div>\n        </div>\n    </li>`\n    )\n    .join('');\n  //scrolling from 2 render\n\n  gallery.insertAdjacentHTML('beforeend', html);\n  lightbox.refresh();\n  //scrolling\n  if (renderCount >= 1) {\n    // get height of 1 card\n    const galleryItemHeight = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect().height;\n    // smooth scrolling on height*2\n    window.scrollBy({ top: galleryItemHeight * 2, behavior: 'smooth' });\n  }\n  renderCount++;\n}\n\nfunction loadMorePics(event) {\n  pageNum++;\n  getImages(currentQuery, 15, pageNum).then(response => {\n    const totalHits = response.totalHits || 0;\n    const currentHits = pageNum * 15;\n\n    if (currentHits >= totalHits) {\n      loadMore.classList.add('is-hidden'); // hide button\n      iziToast.info({\n        title: 'Info',\n        message: `We're sorry, but you've reached the end of search results.`,\n        backgroundColor: '#4CAF50',\n        messageColor: '#fff',\n        titleColor: '#fff',\n        progressBarColor: '#4CAF50',\n        position: 'topRight',\n      });\n    } else {\n      renderGalleryImages(response.hits);\n    }\n    //call func and give response\n  });\n}\n"],"names":["axios","keyApi","getImages","query","perPage","pageNum","queryParams","gallery","form","loader","loadMore","inputValue","currentQuery","imageFetch","loadMorePics","event","iziToast","response","renderGalleryImages","error","lightbox","SimpleLightbox","renderCount","images","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","galleryItemHeight","totalHits"],"mappings":"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"}